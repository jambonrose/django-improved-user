[tox]
isolated_build = True
envlist =
	py311-django42-pkgcheck,
	py312-docs,
	py{36,37,38,39}-django{22,30,31}-unit,
	py{36,37,38,39,310}-django32-unit,
	py{38,39,310}-django40-unit,
	py{38,39,310,311}-django41-unit,
	py{38,39,310,311,312}-django42-unit,
	py39-django{22,32,42}-{extension,replacement}

[testenv]
changedir =
	docs: docs
	extension: example_extension_project
	replacement: example_replacement_project
	unit: {toxinidir}
skip_install =
	pkgcheck: true
extras =
	{extension,
	replacement,unit}: factory
setenv =
	PYTHONDONTWRITEBYTECODE=1
	{extension,replacement,unit}: PYTHONWARNINGS=once
deps =
	{extension,pkgcheck,replacement,unit}: -r{toxinidir}/requirements.txt
	docs: -r{toxinidir}/doc-requirements.txt
	extension: -r{toxinidir}/example_extension_project/requirements.txt
	replacement: -r{toxinidir}/example_replacement_project/requirements.txt
	django22: Django>=2.2,<2.3
	django30: Django>=3.0,<3.1
	django31: Django>=3.1,<3.2
	django32: Django>=3.2,<3.3
	django40: Django>=4.0,<4.1
	django41: Django>=4.1,<4.2
	django42: Django>=4.2,<4.3
commands =
	docs: sphinx-build -W -b html -d {envtmpdir}/doctrees . {envtmpdir}/html
	docs: python -msphinx -b linkcheck . build/linkcheck
	{extension,replacement}: coverage erase
	{extension,replacement}: coverage run manage.py test {posargs}
	{extension,replacement}: coverage combine --append
	{extension,replacement}: coverage report
	pkgcheck: check-manifest {toxinidir}
	unit: coverage erase
	unit: coverage run runtests.py {posargs}
	unit: coverage combine --append
	unit: coverage report
